<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viborita</title>
    <style>
        body{
            background: #666;
            text-align: center;
            margin: 60px 0 0 0;
        }
        canvas{
            border: solid 6px #fff;
            background: cornflowerblue;
        }
    </style>
</head>
<body>
    <canvas width="500px" height="500px"></canvas>
    
    <script>
        let direccion
        //instancio el intervalo
        const INTERVALO = 80
        let controles = {direccion:{x: 1, y:0}, bicho:[{x:0, y:0}]}

        //creo un objeto donde se pueda guardar las teclas que voy a presionar
        const DIRECCION = {
            ArrowDown: [0, 1],
            ArrowUp: [0, -1],
            ArrowRight: [1, 0],
            ArrowLeft: [-1, 0],
            A: [-1, 0],
            D: [1, 0],
            S: [0, 1],
            W: [0, -1],
            a: [-1, 0],
            d: [1, 0],
            s: [0, 1],
            w: [0, -1]
        }

        //Referencio el canvas en JS
        let papel = document.querySelector("canvas")
        //Referencio el contexto del canvas y lo guardo en una variable
        let ctx = papel.getContext("2d")
        

        let looper = ()=>{
            //referencio la cabeza del bicho
            const sq = controles.bicho[0]
            //referencio la direccion actual
            let dx = controles.direccion.x
            let dy = controles.direccion.y
            //le sumo la direccion a su posicion
            sq.x += dx
            sq.y += dy
            //llamo animacion dibujar
            requestAnimationFrame(dibujar)
            //llamo a la funcion despues de cierto intervalo
            setTimeout(looper, INTERVALO)
        }
        //Capturo las teclas que se presionan
        document.onkeydown = (e) => {
            //guardo en direccion la nueva direccion
            direccion = DIRECCION [e.key]
            const [x, y] = direccion
            //valido que no se pueda ir en direccion opuesta
            if(-x !== controles.direccion.x && -y !==controles.direccion.y){
                controles.direccion.x = x
                controles.direccion.y = y
            }
        } 

        let dibujar = (color)=>{
            //borro el ctx
            ctx.clearRect(0, 0, 500, 500)
            //Indico color del dibujo
            ctx.fillStyle = 'green'
            const sq = controles.bicho[0]
            // Crear un rectangulo (x, y, ancho, alto)
            ctx.fillRect(sq.x*10, sq.y*10, 10, 10)
        }

        //cuando el documento carga, llamo a looper
        window.onload = ()=>{
            looper()
        }
    </script>
</body>
</html>